### Read in shotlink data from the start of the 2015 season

shotlink_shots = tbl(golf_research, "pga_shot_by_shot") %>%
  dplyr::filter(year >= 2015) %>%
  group_by(year, perm_num, player_id, round_no) %>%
  dplyr::mutate(
    shotlink_verified = ifelse(all(x_cord == 0) & all(y_cord == 0) & all(z_cord == 0), FALSE, TRUE) # Note any player event rounds that have no x, y and z coordinates - this indicates that shotlink was not in use
  ) %>% 
  ungroup() %>%
  dplyr::filter(
    shotlink_verified == TRUE # Remove any data where shotlink was not in use 
  ) %>%
  dplyr::select(year, perm_num, player_id, round_no, hole_no, shot_seq = shot_sequence, shot_type, shot_strokes, from_loc, to_loc, distance_to_pin, in_hole, dtp_after_shot, strokes_gained_type, strokes_gained_against_baseline, recovery_shot, hole_score, hole_par) %>%
  left_join(
    tbl(golf_research, "shotlink_schedule") %>%
      dplyr::select(year, perm_num, format)
  ) %>% # Join in the competition format for each unique event 
  dplyr::filter(
    format == "STD" # Remove all events that are not defined as stroke-play competitions 
  ) %>%
  dplyr::select(-format) %>%
  collect
